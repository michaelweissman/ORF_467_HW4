ypix = [508
517
512
499
495
500
512
504
513
495
513
514
490
513
507
495
499
507
504
512
511
495
507
517
517
507
504
508
517
517
508
494
490
508
511
517
500
517
503
513
518
517
508
499
504
499
517
508
507
513
504
512
491
512
517
495];

xpix = [2487
2481
2485
2484
2503
2498
2493
2489
2500
2507
2477
2480
2504
2487
2482
2488
2499
2504
2495
2501
2481
2504
2493
2498
2488
2499
2504
2476
2475
2472
2491
2479
2497
2496
2475
2501
2505
2493
2476
2493
2471
2483
2502
2507
2476
2477
2477
2479
2477
2474
2479
2488
2479
2497
2479
2497];

a = [2.5
0.75
3.75
20
1.5
4
4.5
15
4
2.25
4
4
4.5
1.5
2.25
15
9.75
1.5
2.25
3.75
3
1.5
1.5
5
6
6.75
7.5
2.5
2.25
1
2
1.25
50
3
2.5
2
2.5
4
1
3.5
0.5
4
3
2.25
1
1.5
2.25
3
5.25
3
5
2.25
1.5
3
1.5
1.5];

a = sqrt(a);

F = diag(a);

for i = 1:56
    for j = 1:56
        if i ~= j
            F(i,j) = sqrt((xpix(j) - xpix(i))^2 + (ypix(j) - ypix(i))^2);
        end
    end
end

F2 = (1./(F*1.2)).^2;
D = sqrt(1./F2)/2;

A =[4000
5000
3000
0
200
300
2000
150000
2000
200
2000
2000
500
900
300
0
600
600
2000
2000
2000
300
50
0
0
0
0
100
2000
1000
100
0
0
40000
40000
1000
800
2000
1000
1000
2000
2000
2000
2000
2000
50
400
300
60000
2000
3000
1200
350
2000
500
250];

P =[0
5000
0
0
0
0
800
130000
800
0
0
0
0
400
0
60000
0
0
0
0
0
0
0
40000
40000
35000
35000
0
0
0
0
0
0
0
0
0
0
0
0
400
0
0
0
0
0
0
0
0
0
0
0
800
0
800
0
0];

t = F2*A;
d =(F2.*A');

A2 = sum(((F2.*A')./ (F2*A)) .*P, 1)';
A2_new = A.*A./A2;
A2_new(isnan(A2_new)) = 0 ;
A3 = sum(((F2.*A2_new')./ (F2*A2_new)) .*P, 1)';
A3_new = A.*A2_new./A3
A3_new(isnan(A3_new)) = 0 
A4 = sum(((F2.*A3_new')./ (F2*A3_new)) .*P, 1)';
A4_new = A.*A3_new./A4;
A4_new(isnan(A4_new)) = 0 ;
A5 = sum(((F2.*A4_new')./ (F2*A4_new)) .*P, 1)';
A5_new = A.*A4_new./A5;
A5_new(isnan(A5_new)) = 0 ;
A6 = sum(((F2.*A5_new')./ (F2*A5_new)) .*P, 1)';
A6_new = A.*A5_new./A6;
A6_new(isnan(A6_new)) = 0 ;
A7 = sum(((F2.*A6_new')./ (F2*A6_new)) .*P, 1)';
A7_new = A.*A6_new./A7;
A7_new(isnan(A7_new)) = 0 ;
A8 = sum(((F2.*A7_new')./ (F2*A7_new)) .*P, 1)';
A8_new = A.*A7_new./A8;
A8_new(isnan(A8_new)) = 0; 
A9 = sum(((F2.*A8_new')./ (F2*A8_new)) .*P, 1)';
A9_new = A.*A8_new./A7;
A9_new(isnan(A9_new)) = 0; 

T = ((F2.*A8_new')./ (F2*A8_new)) .*P;


E(1) = sum(abs(A2 - A))/sum(A);
E(2) = sum(abs(A3 - A))/sum(A);
E(3) = sum(abs(A4 - A))/sum(A);
E(4) = sum(abs(A5 - A))/sum(A);
E(5) = sum(abs(A6 - A))/sum(A);
E(6) = sum(abs(A7 - A))/sum(A);
E(7) = sum(abs(A8 - A))/sum(A);
E(8) = sum(abs(A9 - A))/sum(A);

TripMiles = reshape(D.*T, 3136,1)
Distance = reshape(D,3136,1)
Trips = reshape(T,3136,1)

size(Distance)
size(TripMiles)
size(Trips)

Q = cat(2, Distance, Trips, TripMiles)

xlswrite('Home_School', Q)





